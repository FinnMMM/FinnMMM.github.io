
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Dynamic Programming | Myease „ÅÆ Page</title>
    <meta name="author" content="Myease" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>






<script src="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.min.css" />
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline-meta.min.css" />




<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>Âä†ËΩΩËøáÊÖ¢ËØ∑ÂºÄÂêØÁºìÂ≠ò ÊµèËßàÂô®ÈªòËÆ§ÂºÄÂêØ</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>MYEASE „ÅÆ PAGE</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;MYEASE „ÅÆ PAGE</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article-toc">
    
    <div id="toccard">
        <div id="toccard-style">
    <div id="card-div">
        <div class="description">
            <h2><span id="x2b50ÊñáÁ´†ÁõÆÂΩïx2b50"><span class="emoji" alias="star" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">&#x2b50;</span>ÊñáÁ´†ÁõÆÂΩï<span class="emoji" alias="star" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">&#x2b50;</span></span></h2>
<!-- toc -->
<ul>
<li><a href="#dynamic-programming">Dynamic Programming</a>
<ul>
<li><a href="#definition">Definition</a></li>
<li><a href="#subset-sum">Subset Sum</a></li>
<li><a href="#weighted-independent-set-on-paths">Weighted Independent set on Paths</a></li>
<li><a href="#ordering-matrices-multiplication">Ordering Matrices Multiplication</a></li>
<li><a href="#knapsack-problem">Knapsack Problem</a></li>
<li><a href="#optimal-bst">Optimal BST</a></li>
<li><a href="#shortest-path">Shortest Path</a></li>
<li><a href="#all-pairs-shortest-path">All Pairs Shortest Path</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p><span class="emoji" alias="point_down" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png?v8">
        </div>
    </div>
</div>


    </div>
    
    <div class="article">
        <div>
            <h1>Dynamic Programming</h1>
        </div>
        <div class="info">
            <span class="date">
                <span class="icon">
                    <i class="fa-solid fa-calendar fa-fw"></i>
                </span>
                2024/12/25
            </span>
            
            
            <span class="tags">
                <span class="icon">
                    <i class="fa-solid fa-tags fa-fw"></i>
                </span>
                
                
                <span class="tag">
                    
                    <a href="/tags/ADS/" style="color: #03a9f4">
                        ADS
                    </a>
                </span>
                
            </span>
            
        </div>
        
        <div class="content" v-pre>
            <h2><span id="x2b50ÊñáÁ´†ÁõÆÂΩïx2b50"><span class="emoji" alias="star" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">&#x2b50;</span>ÊñáÁ´†ÁõÆÂΩï<span class="emoji" alias="star" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">&#x2b50;</span></span></h2>
<!-- toc -->
<ul>
<li><a href="#dynamic-programming">Dynamic Programming</a>
<ul>
<li><a href="#definition">Definition</a></li>
<li><a href="#subset-sum">Subset Sum</a></li>
<li><a href="#weighted-independent-set-on-paths">Weighted Independent set on Paths</a></li>
<li><a href="#ordering-matrices-multiplication">Ordering Matrices Multiplication</a></li>
<li><a href="#knapsack-problem">Knapsack Problem</a></li>
<li><a href="#optimal-bst">Optimal BST</a></li>
<li><a href="#shortest-path">Shortest Path</a></li>
<li><a href="#all-pairs-shortest-path">All Pairs Shortest Path</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p><span class="emoji" alias="point_down" style fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png?v8">üëá</span></p>
<h2><span id="dynamic-programming">Dynamic Programming</span></h2>
<h3><span id="definition">Definition</span></h3>
<p>The main trouble when solving problems using recursion is that the growth of redundant calculations is explosive. So we need to use dynamic programming, recording the recently computed values, to avoid recursive calls.</p>
<ul>
<li>1.Define subproblems</li>
<li>2.Find base cases and recurece relation</li>
<li>3.Computing the optimal values for all subproblems</li>
<li>4.reconstruct the optimal solution from the optimal values of subproblems</li>
</ul>
<h3><span id="subset-sum">Subset Sum</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Given a set of integers, find a subset of integers that has a sum equal to a given target value.</p>
<h5><span id="algorithm">Algorithm</span></h5>
<ul>
<li>1.Define subproblems:
<ul>
<li>$S(i,t)=\lbrace y|y\leq t and y =a_1x_1+a_2x_2+\cdots+a_ix_i,x_i\in\lbrace 0,1\rbrace$</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$S(0,t)=\lbrace 0\rbrace$</li>
<li>$S(i,0)=\emptyset$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>$S(i+1,t)=(S(i,t)\cup \lbrace a_{i+1}\rbrace)\cup (S(i,t)+\lbrace a_{i+1}\rbrace)\cap [0,t]$</li>
</ul>
</li>
<li>4.Result is the subset of $S(n,t)$ whose sum is equal to $t$.</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(nt)$</p>
<h3><span id="weighted-independent-set-on-paths">Weighted Independent set on Paths</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Given a sequence of $v$ and there corresponding weights.We need to find a subset $S$ with the maximum total weight such that no two vertices in $S$ are adjacent.</p>
<h5><span id="algorithm">Algorithm</span></h5>
<ul>
<li>1.Define subproblems:
<ul>
<li>$S(i)=$ the total weight optimal solution for $v_1,v_2,v_3,\cdots,v_i$</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$S(0)=0$</li>
<li>$S(1)=w_1$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>$S(i)=\max\lbrace S(i-1),S(i-2)+w_i\rbrace$</li>
</ul>
</li>
<li>4.Result is the subset of $S(n)$ whose total weight is maximum.</li>
<li>5.Output:
<ul>
<li>if $C[n] \neq C[n-1]$: print($v_n$),n=n-2</li>
<li>else: n=n-1</li>
</ul>
</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(n)$</p>
<h3><span id="ordering-matrices-multiplication">Ordering Matrices Multiplication</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>For three Matrices $M_{a\times b},M_{b\times c},M_{c\times d}$, when we multiply them together,we have two options:</p>
<ul>
<li>1.$(M_{a\times b}\times M_{b\times c}) \times M_{c\times d}$, the total running time is $abc+acd$</li>
<li>2.$M_{a\times b}\times (M_{b\times c} \times M_{c\times d})$, the total running time is $bcd+abd$<br>
The problem is: given a sequance of $n$ matrices, find the optimal order to multiply them together to minimize the total running time.</li>
</ul>
<h5><span id="algorithm">Algorithm</span></h5>
<p>Define $b_i$ as the number of ways to multiply i matrices together.</p>
<p>We have: $b_1=1,b_2=1,b_3=2,b_4=5,\cdots,b_n=\sum_{i=1}^{n-1}b_i\times b_{n-i}$</p>
<ul>
<li>1.Define subproblems:
<ul>
<li>$c[i][j]$ is the minimum cost to multiply $M_i$ to $M_j$</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$c[i][i]=0$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>$c[i][j]=\min\lbrace c[i][k]+c[k+1][j]+r_{i-1}\times r_{k}\times r_{j},k \isin [i,j]\rbrace$</li>
</ul>
</li>
<li>4.$c[0][n]$ is the optimal cost to multiply all matrices together.</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(n^3)$</p>
<h3><span id="knapsack-problem">Knapsack Problem</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Given a set consisting of $N$ items, where the $i$-th item has size $s_i$ and value $v_i$, and a knapsack capacity $c$, The task is to find a subset of items with the maximum total value such that its total size does not exceed the capacity c.</p>
<h5><span id="algorithm">Algorithm</span></h5>
<ul>
<li>1.Define subproblems:
<ul>
<li>$v[i][j]$ be the maximum value for the first $i$ items and a knapsack capacity of $j$.</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$v[0][j]=0$</li>
<li>$v[i][0]=0$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>$v[i][j]=\max\lbrace v[i-1][j],v[i-1][j-s_i]+v_i\rbrace$</li>
</ul>
</li>
<li>4.The maximum value for the first $N$ items and a knapsack capacity of $c$ is $v[N][c]$.</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(nc)$</p>
<h3><span id="optimal-bst">Optimal BST</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Given n keys and their corresponding frequencies,we need to find a BST with minimum average search time($\sum_{i=1}^nf_id(i)$).</p>
<h5><span id="algorithm">Algorithm</span></h5>
<p>Define Tree T as follows:<br>
<img src="/2024/12/25/ads-9/1.jpg" alt><br>
We have:</p>
<ul>
<li>
<p>depth of $k$ in T ($k\leq r-1$) = 1 + depth of $k$ in $L$</p>
</li>
<li>
<p>$\sum_{i=1}^nf_id_i^T=\sum_{i=1}^{r-1}f_i(1+d_i^L)+\sum_{i=r+1}^nf_i(1+d_i^R)=\sum_{i=1}^nf_i+\sum_{i=1}^{r-1}f_id_i^L+\sum_{i=r+1}^nf_id_i^R$</p>
</li>
<li>
<p>1.Define subproblems:</p>
<ul>
<li>$D[i][j]$ is the average depth of the optimal BST for keys $\in [i,j]$</li>
</ul>
</li>
<li>
<p>2.Find base cases:</p>
<ul>
<li>$D[i][i]=0$</li>
</ul>
</li>
<li>
<p>3.Recurrence relation:</p>
<ul>
<li>$D[i][j]=min_{i\leq r\leq j}\lbrace \sum_{k=i}^jf_i+D[i][r-1]+D[r+1][j]\rbrace$</li>
</ul>
</li>
<li>
<p>4.The minimum average search time is $\min_{i=1}^nD[1][n]$.</p>
</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(n^3)$</p>
<h5><span id="enhanced-version">Enhanced version</span></h5>
<p>For $D[i][j]$ and $D[i+1][j]$,$r$ and $r‚Äô$ are the root of the two subtrees respectively,we have:</p>
<ul>
<li>$r \leq r‚Äô$</li>
</ul>
<p>The same,for $D[i][j]$ and $D[i][j-1]$,$r$ and $r‚Äô'$ are the root of the two subtrees respectively,we have:</p>
<ul>
<li>$r \geq r‚Äô'$</li>
</ul>
<p>Then we can optimize the recurrence relation as follows:</p>
<ul>
<li>$D[i][j]=min_{r‚Äô‚Äò\leq r\leq r‚Äô}\lbrace \sum_{k=i}^jf_i+D[i][r-1]+D[r+1][j]\rbrace$</li>
</ul>
<h5><span id="complexity-analysis">Complexity Analysis</span></h5>
<p>$T(n)=O(n^2)$</p>
<h3><span id="shortest-path">Shortest Path</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Given a graph $G=(V,E)$, with edge weights $w_{ij}$, and two vertices $s$ and $t$, we need to find the shortest path from vertex $s$ to vertex $t$.</p>
<h5><span id="algorithm">Algorithm</span></h5>
<p>We can use Dijkstra‚Äôs algorithm to solve this problem,which takes $O(|V|\log |V| + |E|)$ time.</p>
<p>But there is also a more efficient algorithm called Bellman-Ford algorithm, which takes $O(VE)$ time.</p>
<ul>
<li>1.Define subproblems:
<ul>
<li>$c[v][i]$ is the cost of the shortest path from $s$ to $v$ using at most $i$ edges.</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$c[s][0]=0$</li>
<li>$c[v][0]=+\infty$ for all $v\neq s$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>$c[v][i]=\min\lbrace c[v][i-1],\min_{u\in E(v)}\lbrace c[u][i-1]+w_{uv}\rbrace$</li>
</ul>
</li>
<li>4.The cost of the shortest path from $s$ to $t$ is $c[t][|E|]$.</li>
</ul>
<h5><span id="lemma">Lemma</span></h5>
<p>G has no negtive cycles if and only if $c[v][n] == c[v][n-1]$ for all $v\in V$.</p>
<h3><span id="all-pairs-shortest-path">All Pairs Shortest Path</span></h3>
<h5><span id="descriptions">Descriptions</span></h5>
<p>Apart from the previous problem, we need to find the shortest path between all pairs of vertices in a graph.</p>
<h5><span id="algorithm">Algorithm</span></h5>
<p>If use single-source algorithms like Dijkstra‚Äôs algorithm and Bellman-Ford algorithm to solve this problem, they need to run $|V|$ times,and the time complexity is $O(|V|^2\log |V| + |V||E|)$ and $O(|V|^2|E|)$ respectively.</p>
<p>We can use Floyd-Warshall algorithm to solve this problem, which takes $O(|V|^3)$ time.</p>
<p>For a path $p$, we define $rank(p)$ as the largest index of its internal nodes(exclude the source and destination nodes).</p>
<ul>
<li>1.Define subproblems:
<ul>
<li>$c[i][j][k]$ is the cost of the shortest path from $i$ to $j$ with $rank(p)\leq k$.</li>
</ul>
</li>
<li>2.Find base cases:
<ul>
<li>$c[i][j][0]=\begin{cases}w_e\ \infty \end{cases}$</li>
</ul>
</li>
<li>3.Recurrence relation:
<ul>
<li>case 1: $rank(p‚Äô)\leq k-1$:
<ul>
<li>$c[i][j][k]=C[i][j][k-1]$</li>
</ul>
</li>
<li>case 2: $rank(p‚Äô)=k$:
<ul>
<li>$c[i][j][k]=c[i][k][k-1]+c[k][j][k-1]$</li>
</ul>
</li>
<li>$c[i][j][k]=min\lbrace case 1,case 2\rbrace$</li>
</ul>
</li>
<li>4.The cost of the shortest path from $i$ to $j$ is $c[i][j][|V|]$.</li>
</ul>
<pre><code class="language-pesudo">/* A[ ] contains the adjacency matrix with A[ i ][ i ] = 0 */ 
/* D[ ] contains the values of the shortest path */ 
/* N is the number of vertices */ 
/* A negative cycle exists iff D[ i ][ i ] &lt; 0 */ 
void AllPairs( TwoDimArray A, TwoDimArray D, int N ) 
&#123;   int  i, j, k; 
    for ( i = 0; i &lt; N; i++ )  /* Initialize D */ 
         for( j = 0; j &lt; N; j++ )
	 D[ i ][ j ] = A[ i ][ j ]; 
    for( k = 0; k &lt; N; k++ )  /* add one vertex k into the path */
         for( i = 0; i &lt; N; i++ ) 
	 for( j = 0; j &lt; N; j++ ) 
	    if( D[ i ][ k ] + D[ k ][ j ] &lt; D[ i ][ j ] ) 
		/* Update shortest path */ 
		 D[ i ][ j ] = D[ i ][ k ] + D[ k ][ j ]; 
&#125;
</code></pre>
<h5><span id="lemma">Lemma</span></h5>
<p>G has a negtive cycle if and only if $c[i][i][n]&lt;0$ for some i.</p>
<div style="font-size:16px"><span style="float:right"><a href="https://finnmmm.github.io/2024/12/25/ads-10" target="_self">‰∏ã‰∏ÄÁØá : Incomputable Problems & Complexity Classes</a></span><a href="https://finnmmm.github.io/2024/12/25/ads-8" target="_self">‰∏ä‰∏ÄÁØá : Divide and Conquer & Time Compute<a></a></a></div>
        </div>

        
        
        
        
        
        <div id="comment">
            <div id="waline-container"></div>
        </div>
        
        
        
    </div>

</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 Myease „ÅÆ Page
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Myease
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    


<script>
    Waline.init({
        el: "#waline-container",
        serverURL: "vercin.vercel.app",
        commentCount: true,
        pageview: false,
        emoji: "https://unpkg.com/@waline/emojis@1.2.0/weibo,https://unpkg.com/@waline/emojis@1.2.0/alus,https://unpkg.com/@waline/emojis@1.2.0/bilibili,https://unpkg.com/@waline/emojis@1.2.0/qq,https://unpkg.com/@waline/emojis@1.2.0/tieba,https://unpkg.com/@waline/emojis@1.2.0/tw-emoji".split(","),
        meta: "nick,mail,link".split(","),
        requiredMeta: "nick".split(","),
        lang: "",
        wordLimit: 0,
        pageSize: "10",
        login: "enable",
        
    });
</script>



    
    <canvas
            id="fireworks"
            style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"
    ></canvas>
    <script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="/js/fireworks.min.js"></script>
</body>
</html>
